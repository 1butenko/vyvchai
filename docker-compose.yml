version: '3.8'

services:
  # Phoenix UI for tracing
  phoenix:
    image: arizephoenix/phoenix:latest
    ports:
      - "6006:6006" # Expose Phoenix UI on localhost:6006
    environment:
      - PHOENIX_PORT=6006

  # Your AI Tutor application
  ai-tutor:
    build: .
    depends_on:
      - phoenix
    volumes:
      - ./data:/app/data # Mount local data folder into the container
    environment:
      # --- Tracing Configuration ---
      - PHOENIX_HOST=phoenix
      - PHOENIX_PORT=6006
      - LANGCHAIN_TRACING_V2=true
      - OTEL_EXPORTER_OTLP_TRACES_ENDPOINT=http://phoenix:6006/v1/traces
      - OTEL_EXPORTER_OTLP_ENDPOINT=http://phoenix:6006/v1/traces
      
      # --- Google API Key ---
      # Make sure to create a .env file with your GOOGLE_API_KEY
      - GOOGLE_API_KEY=${GOOGLE_API_KEY}
      
      # --- Data Path ---
      - DATA_PATH=/app/data
    command: ["python", "main.py"]

networks:
  default:
    driver: bridge
